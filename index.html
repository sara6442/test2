<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مهامي - نظام إدارة المهام</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
    /* ========== تنسيقات كاملة ========== */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    :root {
        --primary-color: #4361ee;
        --secondary-color: #3a0ca3;
        --accent-color: #7209b7;
        --success-color: #4cc9f0;
        --danger-color: #f72585;
        --warning-color: #f8961e;
        --light-color: #f8f9fa;
        --dark-color: #212529;
        --gray-color: #6c757d;
        --border-radius: 12px;
        --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        --transition: all 0.3s ease;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f5f7fb;
        color: var(--dark-color);
        line-height: 1.6;
        min-height: 100vh;
    }

    .container {
        display: flex;
        min-height: 100vh;
        direction: rtl;
    }

    /* الشريط الجانبي */
    .sidebar {
        width: 250px;
        background: linear-gradient(180deg, var(--primary-color), var(--secondary-color));
        color: white;
        padding: 20px 0;
        display: flex;
        flex-direction: column;
        box-shadow: var(--box-shadow);
        position: fixed;
        height: 100vh;
        right: 0;
        top: 0;
    }

    .logo {
        padding: 0 20px 30px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        margin-bottom: 30px;
    }

    .logo h1 {
        font-size: 1.5rem;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .main-nav {
        flex: 1;
        padding: 0 15px;
    }

    .nav-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px;
        color: rgba(255, 255, 255, 0.9);
        text-decoration: none;
        border-radius: var(--border-radius);
        margin-bottom: 8px;
        transition: var(--transition);
    }

    .nav-item:hover {
        background: rgba(255, 255, 255, 0.1);
        color: white;
    }

    .nav-item.active {
        background: rgba(255, 255, 255, 0.2);
        color: white;
        font-weight: bold;
    }

    .nav-item i {
        font-size: 1.2rem;
        width: 24px;
        text-align: center;
    }

    .user-section {
        padding: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .user-info {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .avatar {
        width: 40px;
        height: 40px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
    }

    .user-details {
        display: flex;
        flex-direction: column;
    }

    .user-name {
        font-weight: bold;
    }

    .user-email {
        font-size: 0.8rem;
        opacity: 0.8;
    }

    /* المحتوى الرئيسي */
    .main-content {
        flex: 1;
        margin-right: 250px;
        padding: 20px;
        width: calc(100% - 250px);
    }

    .main-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding: 20px;
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
    }

    .header-left h2 {
        color: var(--primary-color);
        margin-bottom: 5px;
    }

    .date-display {
        color: var(--gray-color);
        font-size: 0.9rem;
    }

    /* أزرار */
    .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: var(--transition);
        font-weight: 500;
    }

    .btn-primary {
        background: var(--primary-color);
        color: white;
    }

    .btn-primary:hover {
        background: var(--secondary-color);
        transform: translateY(-2px);
    }

    .btn-secondary {
        background: var(--light-color);
        color: var(--dark-color);
        border: 1px solid #dee2e6;
    }

    .btn-secondary:hover {
        background: #e9ecef;
    }

    .btn-danger {
        background: var(--danger-color);
        color: white;
    }

    .btn-danger:hover {
        background: #d9048e;
    }

    .btn-sm {
        padding: 6px 12px;
        font-size: 0.9rem;
    }

    /* شريط التنقل الزمني */
    .time-navigation {
        display: flex;
        gap: 10px;
        margin-bottom: 30px;
        padding: 20px;
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
    }

    .time-btn {
        flex: 1;
        padding: 12px;
        border: 2px solid #e9ecef;
        background: white;
        border-radius: 8px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        font-size: 1rem;
        transition: var(--transition);
    }

    .time-btn:hover {
        border-color: var(--primary-color);
        color: var(--primary-color);
    }

    .time-btn.active {
        background: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
    }

    /* منطقة المحتوى */
    .content-area {
        background: white;
        border-radius: var(--border-radius);
        padding: 30px;
        box-shadow: var(--box-shadow);
        min-height: 500px;
    }

    .view {
        display: none;
    }

    .active-view {
        display: block;
    }

    /* قائمة المهام */
    .tasks-container {
        max-width: 800px;
        margin: 0 auto;
    }

    .tasks-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
    }

    .tasks-header h3 {
        color: var(--primary-color);
    }

    .task-filters select {
        padding: 8px 15px;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        background: white;
        font-size: 1rem;
    }

    .tasks-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .task-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 20px;
        background: var(--light-color);
        border-radius: var(--border-radius);
        border-right: 4px solid var(--primary-color);
        transition: var(--transition);
    }

    .task-item:hover {
        transform: translateX(-5px);
        box-shadow: var(--box-shadow);
    }

    .task-item.completed {
        opacity: 0.7;
        border-color: var(--success-color);
    }

    .task-item.completed .task-title {
        text-decoration: line-through;
    }

    .task-checkbox {
        width: 20px;
        height: 20px;
        cursor: pointer;
    }

    .task-content {
        flex: 1;
    }

    .task-title {
        font-weight: bold;
        margin-bottom: 5px;
    }

    .task-description {
        color: var(--gray-color);
        font-size: 0.9rem;
        margin-bottom: 10px;
    }

    .task-meta {
        display: flex;
        gap: 15px;
        font-size: 0.85rem;
        color: var(--gray-color);
    }

    .task-actions {
        display: flex;
        gap: 10px;
    }

    /* النوافذ المنبثقة */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
    }

    .modal.active {
        display: flex;
    }

    .modal-content {
        background: white;
        border-radius: var(--border-radius);
        width: 90%;
        max-width: 500px;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        border-bottom: 1px solid #dee2e6;
    }

    .close-btn {
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--gray-color);
        transition: var(--transition);
    }

    .close-btn:hover {
        color: var(--danger-color);
    }

    .modal-body {
        padding: 20px;
    }

    .modal-footer {
        padding: 20px;
        border-top: 1px solid #dee2e6;
        display: flex;
        justify-content: flex-end;
        gap: 10px;
    }

    /* نماذج الإدخال */
    .form-group {
        margin-bottom: 20px;
    }

    .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: var(--dark-color);
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
        width: 100%;
        padding: 12px;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        font-size: 1rem;
        transition: var(--transition);
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
    }

    .form-row {
        display: flex;
        gap: 20px;
    }

    .form-row .form-group {
        flex: 1;
    }

    /* التقويم */
    .calendar-container {
        max-width: 1000px;
        margin: 0 auto;
    }

    .daily-view,
    .weekly-view,
    .monthly-view {
        background: white;
        border-radius: var(--border-radius);
        padding: 20px;
    }

    .day-header,
    .week-navigation,
    .month-navigation {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding: 15px;
        background: var(--light-color);
        border-radius: var(--border-radius);
    }

    .nav-btn {
        padding: 8px 16px;
        border: 1px solid #dee2e6;
        background: white;
        border-radius: 8px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: var(--transition);
    }

    .nav-btn:hover {
        border-color: var(--primary-color);
    }

    .week-calendar,
    .month-calendar {
        display: grid;
        gap: 15px;
    }

    .week-calendar {
        grid-template-columns: repeat(7, 1fr);
    }

    .month-calendar {
        grid-template-columns: repeat(7, 1fr);
    }

    .day-cell {
        background: var(--light-color);
        border-radius: 8px;
        padding: 15px;
        min-height: 120px;
        border: 1px solid #dee2e6;
    }

    .day-cell.current-day {
        background: rgba(67, 97, 238, 0.1);
        border-color: var(--primary-color);
    }

    .day-number {
        font-weight: bold;
        margin-bottom: 10px;
        color: var(--primary-color);
    }

    .day-name {
        font-size: 0.9rem;
        color: var(--gray-color);
        margin-bottom: 10px;
    }

    .day-tasks {
        margin-top: 10px;
        display: flex;
        flex-direction: column;
        gap: 5px;
    }

    .calendar-task {
        background: white;
        border-radius: 6px;
        padding: 8px;
        margin-bottom: 5px;
        border-right: 3px solid var(--primary-color);
        font-size: 0.85rem;
    }

    .calendar-task .task-title {
        font-size: 0.9rem;
        margin-bottom: 3px;
    }

    .calendar-task .task-time {
        font-size: 0.8rem;
        color: var(--gray-color);
    }

    /* الفئات */
    .categories-container {
        max-width: 800px;
        margin: 0 auto;
    }

    .categories-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .category-item {
        background: var(--light-color);
        border-radius: var(--border-radius);
        padding: 20px;
        display: flex;
        align-items: center;
        gap: 15px;
        transition: var(--transition);
        border: 2px solid transparent;
    }

    .category-item:hover {
        transform: translateY(-5px);
        box-shadow: var(--box-shadow);
        border-color: var(--primary-color);
    }

    .category-color {
        width: 20px;
        height: 20px;
        border-radius: 50%;
    }

    .category-name {
        font-weight: bold;
        flex: 1;
    }

    .category-actions {
        display: flex;
        gap: 10px;
    }

    /* إحصائيات */
    .stats-container {
        max-width: 800px;
        margin: 0 auto;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 30px;
    }

    .stat-card {
        background: white;
        border-radius: var(--border-radius);
        padding: 30px;
        text-align: center;
        box-shadow: var(--box-shadow);
        transition: var(--transition);
        border: 1px solid #dee2e6;
    }

    .stat-card:hover {
        transform: translateY(-5px);
    }

    .stat-icon {
        font-size: 2rem;
        margin-bottom: 15px;
    }

    .stat-value {
        font-size: 2.5rem;
        font-weight: bold;
        color: var(--primary-color);
        margin: 10px 0;
    }

    .stat-label {
        color: var(--gray-color);
        font-size: 0.9rem;
    }

    .stat-sub {
        font-size: 0.8rem;
        color: var(--gray-color);
        margin-top: 5px;
    }

    /* حالة فارغة */
    .empty-state {
        text-align: center;
        padding: 40px 20px;
        color: var(--gray-color);
    }

    .empty-state i {
        margin-bottom: 20px;
        opacity: 0.5;
    }

    .empty-state h4 {
        margin-bottom: 10px;
        color: var(--dark-color);
    }

    .empty-day {
        text-align: center;
        color: var(--gray-color);
        font-size: 0.9rem;
        padding: 10px;
    }

    .task-indicator {
        width: 8px;
        height: 8px;
        background: var(--primary-color);
        border-radius: 50%;
        margin-top: 5px;
    }

    .day-cell.has-tasks {
        border-color: var(--primary-color);
    }

    /* تصميم متجاوب */
    @media (max-width: 992px) {
        .sidebar {
            width: 70px;
            padding: 20px 0;
        }
        
        .sidebar .logo h1 span,
        .sidebar .nav-item span,
        .sidebar .user-details {
            display: none;
        }
        
        .sidebar .logo h1 {
            justify-content: center;
        }
        
        .main-content {
            margin-right: 70px;
            width: calc(100% - 70px);
        }
        
        .nav-item {
            justify-content: center;
            padding: 15px 0;
        }
        
        .user-info {
            justify-content: center;
        }
    }

    @media (max-width: 768px) {
        .container {
            flex-direction: column;
        }
        
        .sidebar {
            position: static;
            width: 100%;
            height: auto;
            flex-direction: row;
            padding: 10px;
        }
        
        .main-nav {
            display: flex;
            gap: 10px;
        }
        
        .logo {
            display: none;
        }
        
        .user-section {
            display: none;
        }
        
        .main-content {
            margin-right: 0;
            width: 100%;
        }
        
        .form-row {
            flex-direction: column;
            gap: 10px;
        }
        
        .time-navigation {
            flex-direction: column;
        }
        
        .week-calendar,
        .month-calendar {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 576px) {
        .week-calendar,
        .month-calendar {
            grid-template-columns: 1fr;
        }
        
        .modal-content {
            width: 95%;
            margin: 10px;
        }
        
        .categories-list {
            grid-template-columns: 1fr;
        }
        
        .stats-grid {
            grid-template-columns: 1fr;
        }
        
        .main-header {
            flex-direction: column;
            gap: 15px;
            text-align: center;
        }
    }
    </style>
</head>
<body>
    <div class="container">
        <!-- الشريط الجانبي -->
        <aside class="sidebar">
            <div class="logo">
                <h1><i class="fas fa-tasks"></i> <span>مهامي</span></h1>
            </div>
            
            <nav class="main-nav">
                <a href="#" class="nav-item active" data-view="tasks">
                    <i class="fas fa-list-check"></i>
                    <span>المهام</span>
                </a>
                <a href="#" class="nav-item" data-view="calendar">
                    <i class="fas fa-calendar-days"></i>
                    <span>الجدول الزمني</span>
                </a>
                <a href="#" class="nav-item" data-view="stats">
                    <i class="fas fa-chart-pie"></i>
                    <span>الإحصائيات</span>
                </a>
                <a href="#" class="nav-item" data-view="categories">
                    <i class="fas fa-tags"></i>
                    <span>إدارة الفئات</span>
                </a>
            </nav>
            
            <div class="user-section">
                <div class="user-info">
                    <div class="avatar">م</div>
                    <div class="user-details">
                        <span class="user-name">مستخدم</span>
                        <span class="user-email">user@example.com</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- المحتوى الرئيسي -->
        <main class="main-content">
            <!-- شريط العنوان -->
            <header class="main-header">
                <div class="header-left">
                    <h2 id="current-view-title">المهام</h2>
                    <div id="current-date" class="date-display"></div>
                </div>
                <div class="header-right">
                    <button class="btn btn-primary" id="add-task-btn">
                        <i class="fas fa-plus"></i> إضافة مهمة
                    </button>
                </div>
            </header>

            <!-- شريط التنقل الزمني -->
            <div class="time-navigation" id="time-navigation" style="display: none;">
                <button class="time-btn active" data-range="daily">
                    <i class="fas fa-calendar-day"></i> اليومي
                </button>
                <button class="time-btn" data-range="weekly">
                    <i class="fas fa-calendar-week"></i> الأسبوعي
                </button>
                <button class="time-btn" data-range="monthly">
                    <i class="fas fa-calendar-alt"></i> الشهري
                </button>
            </div>

            <!-- منطقة المحتوى -->
            <div class="content-area">
                <!-- عرض المهام -->
                <div id="tasks-view" class="view active-view">
                    <div class="tasks-container">
                        <div class="tasks-header">
                            <h3>مهام اليوم</h3>
                            <div class="task-filters">
                                <select id="task-filter">
                                    <option value="all">جميع المهام</option>
                                    <option value="today">مهام اليوم</option>
                                    <option value="pending">قيد الانتظار</option>
                                    <option value="completed">مكتملة</option>
                                </select>
                            </div>
                        </div>
                        <div class="tasks-list" id="tasks-list">
                            <!-- المهام ستظهر هنا -->
                        </div>
                    </div>
                </div>

                <!-- عرض الجدول الزمني -->
                <div id="calendar-view" class="view">
                    <div class="calendar-container">
                        <!-- التقويم سيظهر هنا -->
                    </div>
                </div>

                <!-- عرض الإحصائيات -->
                <div id="stats-view" class="view">
                    <div class="stats-container">
                        <h3>إحصائيات المهام</h3>
                        <div class="stats-grid" id="stats-grid">
                            <!-- الإحصائيات ستظهر هنا -->
                        </div>
                    </div>
                </div>

                <!-- عرض إدارة الفئات -->
                <div id="categories-view" class="view">
                    <div class="categories-container">
                        <h3>إدارة الفئات</h3>
                        <button class="btn btn-secondary" id="add-category-btn">
                            <i class="fas fa-plus"></i> إضافة فئة جديدة
                        </button>
                        <div class="categories-list" id="categories-list">
                            <!-- الفئات ستظهر هنا -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- نافذة إضافة مهمة -->
    <div class="modal" id="add-task-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>إضافة مهمة جديدة</h3>
                <button class="close-btn" id="close-task-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="task-form">
                    <div class="form-group">
                        <label for="task-title">عنوان المهمة</label>
                        <input type="text" id="task-title" placeholder="أدخل عنوان المهمة" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="task-description">وصف المهمة (اختياري)</label>
                        <textarea id="task-description" placeholder="أدخل وصف المهمة" rows="3"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="task-category">الفئة</label>
                            <select id="task-category">
                                <!-- سيتم ملؤه بالفئات -->
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="task-duration">المدة (دقائق)</label>
                            <input type="number" id="task-duration" min="1" max="480" value="30">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="task-date">تاريخ التنفيذ</label>
                            <input type="date" id="task-date">
                        </div>
                        
                        <div class="form-group">
                            <label for="task-time">وقت التنفيذ</label>
                            <input type="time" id="task-time">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="task-repeat">التكرار</label>
                        <select id="task-repeat">
                            <option value="none">لا يوجد</option>
                            <option value="daily">يومي</option>
                            <option value="weekly">أسبوعي</option>
                            <option value="monthly">شهري</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-task">إلغاء</button>
                <button class="btn btn-primary" id="save-task">حفظ المهمة</button>
            </div>
        </div>
    </div>

    <!-- نافذة إضافة فئة -->
    <div class="modal" id="add-category-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>إضافة فئة جديدة</h3>
                <button class="close-btn" id="close-category-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="category-form">
                    <div class="form-group">
                        <label for="category-name">اسم الفئة</label>
                        <input type="text" id="category-name" placeholder="أدخل اسم الفئة" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="category-color">لون الفئة</label>
                            <input type="color" id="category-color" value="#4361ee">
                        </div>
                        
                        <div class="form-group">
                            <label for="category-icon">أيقونة الفئة</label>
                            <select id="category-icon">
                                <option value="fas fa-home">منزل</option>
                                <option value="fas fa-briefcase">عمل</option>
                                <option value="fas fa-graduation-cap">دراسة</option>
                                <option value="fas fa-heart">صحة</option>
                                <option value="fas fa-shopping-cart">تسوق</option>
                                <option value="fas fa-tag">عام</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-category">إلغاء</button>
                <button class="btn btn-primary" id="save-category">حفظ الفئة</button>
            </div>
        </div>
    </div>

    <!-- الكود الكامل في ملف واحد -->
    <script>
    // ========== نظام التخزين والبيانات ==========
    class TaskManager {
        constructor() {
    // تحميل المهام
    const tasksData = this.loadFromStorage('tasks');
    this.tasks = Array.isArray(tasksData) ? tasksData : [];
    
    // تحميل الفئات - التأكد أنها مصفوفة
    const categoriesData = this.loadFromStorage('categories');
    if (Array.isArray(categoriesData) && categoriesData.length > 0) {
        this.categories = categoriesData;
    } else {
        this.categories = this.getDefaultCategories();
    }
    
    this.initSampleData();
}

        loadFromStorage(key) {
            try {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : null;
            } catch (e) {
                console.error(`خطأ في تحميل ${key}:`, e);
                return null;
            }
        }

        saveToStorage(key, data) {
            try {
                localStorage.setItem(key, JSON.stringify(data));
            } catch (e) {
                console.error(`خطأ في حفظ ${key}:`, e);
            }
        }

        getDefaultCategories() {
            return [
                {
                    id: 'personal',
                    name: 'مهام شخصية',
                    color: '#4361ee',
                    icon: 'fas fa-home',
                    createdAt: new Date().toISOString()
                },
                {
                    id: 'work',
                    name: 'عمل',
                    color: '#f72585',
                    icon: 'fas fa-briefcase',
                    createdAt: new Date().toISOString()
                },
                {
                    id: 'study',
                    name: 'دراسة',
                    color: '#4cc9f0',
                    icon: 'fas fa-graduation-cap',
                    createdAt: new Date().toISOString()
                }
            ];
        }

        initSampleData() {
            if (this.tasks.length === 0) {
                this.tasks = [
                    {
                        id: '1',
                        title: 'تسليم تقرير العمل',
                        description: 'تسليم التقرير النهائي للمشروع',
                        categoryId: 'work',
                        duration: 60,
                        date: new Date().toISOString().split('T')[0],
                        time: '14:00',
                        repeat: 'none',
                        completed: false,
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: '2',
                        title: 'شراء مستلزمات المنزل',
                        description: 'شراء الخضار والفواكه',
                        categoryId: 'personal',
                        duration: 45,
                        date: new Date().toISOString().split('T')[0],
                        time: '18:00',
                        repeat: 'weekly',
                        completed: true,
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: '3',
                        title: 'مراجعة الدروس',
                        description: 'مراجعة الفصل الثالث في الرياضيات',
                        categoryId: 'study',
                        duration: 90,
                        date: new Date().toISOString().split('T')[0],
                        time: '16:00',
                        repeat: 'none',
                        completed: false,
                        createdAt: new Date().toISOString()
                    }
                ];
                this.saveTasks();
            }
            this.saveCategories();
        }

        // وظائف المهام
        addTask(task) {
            this.tasks.push(task);
            this.saveTasks();
        }

        deleteTask(taskId) {
            this.tasks = this.tasks.filter(task => task.id !== taskId);
            this.saveTasks();
        }

        updateTask(taskId, updatedData) {
            const index = this.tasks.findIndex(task => task.id === taskId);
            if (index !== -1) {
                this.tasks[index] = { ...this.tasks[index], ...updatedData };
                this.saveTasks();
            }
        }

        getTasks() {
            return [...this.tasks];
        }

        getTaskById(taskId) {
            return this.tasks.find(task => task.id === taskId);
        }

        getTasksByDate(date) {
            return this.tasks.filter(task => task.date === date);
        }

        getTasksByCategory(categoryId) {
            return this.tasks.filter(task => task.categoryId === categoryId);
        }

        toggleTaskCompletion(taskId) {
            const task = this.getTaskById(taskId);
            if (task) {
                task.completed = !task.completed;
                this.saveTasks();
            }
        }

        saveTasks() {
            this.saveToStorage('tasks', this.tasks);
        }

        // وظائف الفئات
        addCategory(category) {
            this.categories.push(category);
            this.saveCategories();
        }

        deleteCategory(categoryId) {
            this.categories = this.categories.filter(cat => cat.id !== categoryId);
            this.saveCategories();
            
            // تحديث المهام التي تستخدم هذه الفئة
            this.tasks.forEach(task => {
                if (task.categoryId === categoryId) {
                    task.categoryId = 'personal'; // تعيين فئة افتراضية
                }
            });
            this.saveTasks();
        }

        getCategories() {
            return [...this.categories];
        }

        getCategoryById(categoryId) {
            return this.categories.find(cat => cat.id === categoryId);
        }

        saveCategories() {
            this.saveToStorage('categories', this.categories);
        }

        // إحصائيات
        getStatistics() {
            const tasks = this.getTasks();
            const categories = this.getCategories();
            
            const totalTasks = tasks.length;
            const completedTasks = tasks.filter(task => task.completed).length;
            const pendingTasks = totalTasks - completedTasks;
            const completionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
            
            const categoryStats = categories.map(category => {
                const categoryTasks = tasks.filter(task => task.categoryId === category.id);
                const completed = categoryTasks.filter(task => task.completed).length;
                
                return {
                    ...category,
                    total: categoryTasks.length,
                    completed: completed,
                    pending: categoryTasks.length - completed
                };
            });

            return {
                totalTasks,
                completedTasks,
                pendingTasks,
                completionRate,
                categoryStats
            };
        }

        // التقويم
        getTasksByTimeRange(range) {
            const now = new Date();
            const today = now.toISOString().split('T')[0];
            
            switch(range) {
                case 'daily':
                    return this.getTasksByDate(today);
                case 'weekly':
                    const weekStart = new Date(now);
                    weekStart.setDate(weekStart.getDate() - weekStart.getDay());
                    const weekEnd = new Date(weekStart);
                    weekEnd.setDate(weekEnd.getDate() + 6);
                    
                    return this.tasks.filter(task => {
                        const taskDate = new Date(task.date);
                        return taskDate >= weekStart && taskDate <= weekEnd;
                    });
                case 'monthly':
                    const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);
                    const monthEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);
                    
                    return this.tasks.filter(task => {
                        const taskDate = new Date(task.date);
                        return taskDate >= monthStart && taskDate <= monthEnd;
                    });
                default:
                    return this.tasks;
            }
        }

        getCurrentWeek() {
            const now = new Date();
            const day = now.getDay();
            const diff = now.getDate() - day + (day === 0 ? -6 : 1);
            
            const week = [];
            for (let i = 0; i < 7; i++) {
                const dayDate = new Date(now);
                dayDate.setDate(diff + i);
                
                week.push({
                    date: dayDate.toISOString().split('T')[0],
                    day: dayDate.getDate(),
                    name: dayDate.toLocaleDateString('ar-SA', { weekday: 'short' }),
                    fullName: dayDate.toLocaleDateString('ar-SA', { weekday: 'long' })
                });
            }
            
            return week;
        }

        getCurrentMonth() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            
            const monthDays = [];
            
            // أيام فارغة قبل بداية الشهر
            for (let i = 0; i < firstDay.getDay(); i++) {
                monthDays.push(null);
            }
            
            // أيام الشهر
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dayDate = new Date(year, month, day);
                monthDays.push({
                    date: dayDate.toISOString().split('T')[0],
                    day: day,
                    month: month + 1,
                    year: year
                });
            }
            
            return monthDays;
        }
    }

    // ========== واجهة المستخدم ==========
    class UI {
        constructor(taskManager) {
            this.taskManager = taskManager;
            this.currentView = 'tasks';
            this.initializeElements();
            this.setupEventListeners();
            this.initializeApp();
        }

        initializeElements() {
            // العناصر الرئيسية
            this.elements = {
                currentDate: document.getElementById('current-date'),
                currentViewTitle: document.getElementById('current-view-title'),
                addTaskBtn: document.getElementById('add-task-btn'),
                addTaskModal: document.getElementById('add-task-modal'),
                closeTaskModal: document.getElementById('close-task-modal'),
                saveTaskBtn: document.getElementById('save-task'),
                taskForm: document.getElementById('task-form'),
                taskTitle: document.getElementById('task-title'),
                taskDescription: document.getElementById('task-description'),
                taskCategory: document.getElementById('task-category'),
                taskDuration: document.getElementById('task-duration'),
                taskDate: document.getElementById('task-date'),
                taskTime: document.getElementById('task-time'),
                taskRepeat: document.getElementById('task-repeat'),
                cancelTask: document.getElementById('cancel-task'),
                
                addCategoryBtn: document.getElementById('add-category-btn'),
                addCategoryModal: document.getElementById('add-category-modal'),
                closeCategoryModal: document.getElementById('close-category-modal'),
                saveCategoryBtn: document.getElementById('save-category'),
                categoryName: document.getElementById('category-name'),
                categoryColor: document.getElementById('category-color'),
                categoryIcon: document.getElementById('category-icon'),
                cancelCategory: document.getElementById('cancel-category'),
                
                navItems: document.querySelectorAll('.nav-item'),
                views: document.querySelectorAll('.view'),
                timeNavigation: document.getElementById('time-navigation'),
                timeButtons: document.querySelectorAll('.time-btn'),
                
                tasksList: document.getElementById('tasks-list'),
                taskFilter: document.getElementById('task-filter'),
                calendarContainer: document.querySelector('.calendar-container'),
                categoriesList: document.getElementById('categories-list'),
                statsGrid: document.getElementById('stats-grid')
            };
        }

        setupEventListeners() {
            // التنقل
            this.elements.navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    this.switchView(item.dataset.view);
                });
            });

            // الوقت
            this.elements.timeButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    this.elements.timeButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    if (this.currentView === 'calendar') {
                        this.loadCalendarView();
                    }
                });
            });

            // إضافة مهمة
            this.elements.addTaskBtn.addEventListener('click', () => this.openAddTaskModal());
            this.elements.closeTaskModal.addEventListener('click', () => this.closeModal('add-task-modal'));
            this.elements.saveTaskBtn.addEventListener('click', () => this.saveTask());
            this.elements.cancelTask.addEventListener('click', () => this.closeModal('add-task-modal'));

            // إضافة فئة
            this.elements.addCategoryBtn.addEventListener('click', () => this.openAddCategoryModal());
            this.elements.closeCategoryModal.addEventListener('click', () => this.closeModal('add-category-modal'));
            this.elements.saveCategoryBtn.addEventListener('click', () => this.saveCategory());
            this.elements.cancelCategory.addEventListener('click', () => this.closeModal('add-category-modal'));

            // تصفية المهام
            this.elements.taskFilter?.addEventListener('change', () => this.loadTasksView());

            // إغلاق النوافذ عند النقر خارجها
            window.addEventListener('click', (e) => {
                if (e.target === this.elements.addTaskModal) this.closeModal('add-task-modal');
                if (e.target === this.elements.addCategoryModal) this.closeModal('add-category-modal');
            });
        }

        initializeApp() {
            this.updateDate();
            this.switchView('tasks');
        }

        updateDate() {
            const now = new Date();
            const arabicDate = now.toLocaleDateString('ar-SA', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            this.elements.currentDate.textContent = arabicDate;
            
            // تعيين التاريخ الحالي في نموذج المهمة
            if (this.elements.taskDate) {
                this.elements.taskDate.value = now.toISOString().split('T')[0];
            }
        }

        switchView(viewName) {
            this.currentView = viewName;
            
            // تحديث التنقل
            this.elements.navItems.forEach(item => {
                item.classList.remove('active');
                if (item.dataset.view === viewName) {
                    item.classList.add('active');
                }
            });
            
            // تحديث العنوان
            const viewTitles = {
                'tasks': 'المهام',
                'calendar': 'الجدول الزمني',
                'stats': 'الإحصائيات',
                'categories': 'إدارة الفئات'
            };
            this.elements.currentViewTitle.textContent = viewTitles[viewName];
            
            // التحكم بشريط الوقت
            this.elements.timeNavigation.style.display = (viewName === 'calendar') ? 'flex' : 'none';
            
            // إظهار/إخفاء العروض
            this.elements.views.forEach(view => {
                view.classList.remove('active-view');
                if (view.id === `${viewName}-view`) {
                    view.classList.add('active-view');
                }
            });
            
            // تحميل المحتوى
            switch(viewName) {
                case 'tasks':
                    this.loadTasksView();
                    break;
                case 'calendar':
                    this.loadCalendarView();
                    break;
                case 'stats':
                    this.loadStatsView();
                    break;
                case 'categories':
                    this.loadCategoriesView();
                    break;
            }
        }

        // ========== عرض المهام ==========
        loadTasksView() {
            let tasks = this.taskManager.getTasks();
            const filter = this.elements.taskFilter?.value;
            
            // التصفية
            if (filter === 'today') {
                const today = new Date().toISOString().split('T')[0];
                tasks = tasks.filter(task => task.date === today);
            } else if (filter === 'completed') {
                tasks = tasks.filter(task => task.completed);
            } else if (filter === 'pending') {
                tasks = tasks.filter(task => !task.completed);
            }
            
            if (tasks.length === 0) {
                this.elements.tasksList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-tasks fa-3x"></i>
                        <h4>لا توجد مهام</h4>
                        <p>اضغط على "إضافة مهمة" لإنشاء مهمتك الأولى</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            tasks.forEach(task => {
                const category = this.taskManager.getCategoryById(task.categoryId) || 
                    { name: 'عام', color: '#6c757d', icon: 'fas fa-tag' };
                
                html += `
                    <div class="task-item ${task.completed ? 'completed' : ''}" data-id="${task.id}">
                        <input type="checkbox" class="task-checkbox" ${task.completed ? 'checked' : ''}>
                        <div class="task-content">
                            <div class="task-title">${task.title}</div>
                            ${task.description ? `<div class="task-description">${task.description}</div>` : ''}
                            <div class="task-meta">
                                <span><i class="${category.icon}" style="color: ${category.color}"></i> ${category.name}</span>
                                <span><i class="fas fa-clock"></i> ${task.duration} دقيقة</span>
                                ${task.date ? `<span><i class="fas fa-calendar"></i> ${this.formatDate(task.date)}</span>` : ''}
                                ${task.time ? `<span><i class="fas fa-clock"></i> ${task.time}</span>` : ''}
                            </div>
                        </div>
                        <div class="task-actions">
                            <button class="btn btn-danger btn-sm delete-task" data-id="${task.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
            
            this.elements.tasksList.innerHTML = html;
            
            // أحداث المهام
            document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', (e) => {
                    const taskId = e.target.closest('.task-item').dataset.id;
                    this.taskManager.toggleTaskCompletion(taskId);
                    this.loadTasksView();
                });
            });
            
            document.querySelectorAll('.delete-task').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const taskId = e.target.closest('button').dataset.id;
                    if (confirm('هل أنت متأكد من حذف هذه المهمة؟')) {
                        this.taskManager.deleteTask(taskId);
                        this.loadTasksView();
                    }
                });
            });
        }

        // ========== عرض التقويم ==========
        loadCalendarView() {
            const activeBtn = document.querySelector('.time-btn.active');
            const range = activeBtn ? activeBtn.dataset.range : 'daily';
            
            switch(range) {
                case 'daily':
                    this.loadDailyView();
                    break;
                case 'weekly':
                    this.loadWeeklyView();
                    break;
                case 'monthly':
                    this.loadMonthlyView();
                    break;
            }
        }

        loadDailyView() {
            const now = new Date();
            const today = now.toISOString().split('T')[0];
            const arabicDate = now.toLocaleDateString('ar-SA', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            const tasks = this.taskManager.getTasksByDate(today);
            
            let tasksHtml = '';
            if (tasks.length === 0) {
                tasksHtml = '<div class="empty-day">لا توجد مهام لهذا اليوم</div>';
            } else {
                tasks.forEach(task => {
                    const category = this.taskManager.getCategoryById(task.categoryId);
                    tasksHtml += `
                        <div class="calendar-task ${task.completed ? 'completed' : ''}">
                            <div class="task-title">${task.title}</div>
                            <div class="task-meta">
                                ${task.time ? `<span class="task-time"><i class="fas fa-clock"></i> ${task.time}</span>` : ''}
                                ${category ? `<span class="task-category" style="color: ${category.color}"><i class="${category.icon}"></i> ${category.name}</span>` : ''}
                            </div>
                        </div>
                    `;
                });
            }
            
            this.elements.calendarContainer.innerHTML = `
                <div class="daily-view">
                    <div class="day-header">
                        <h3>${arabicDate}</h3>
                        <div class="day-tasks">${tasksHtml}</div>
                    </div>
                </div>
            `;
        }

        loadWeeklyView() {
            const week = this.taskManager.getCurrentWeek();
            const tasks = this.taskManager.getTasksByTimeRange('weekly');
            
            let weekHtml = '';
            week.forEach(day => {
                const dayTasks = tasks.filter(task => task.date === day.date);
                const isToday = day.date === new Date().toISOString().split('T')[0];
                
                let dayTasksHtml = '';
                if (dayTasks.length === 0) {
                    dayTasksHtml = '<div class="empty-day">لا توجد مهام</div>';
                } else {
                    dayTasks.forEach(task => {
                        dayTasksHtml += `
                            <div class="calendar-task ${task.completed ? 'completed' : ''}">
                                <div class="task-title">${task.title}</div>
                                ${task.time ? `<div class="task-time">${task.time}</div>` : ''}
                            </div>
                        `;
                    });
                }
                
                weekHtml += `
                    <div class="day-cell ${isToday ? 'current-day' : ''}">
                        <div class="day-number">${day.day}</div>
                        <div class="day-name">${day.name}</div>
                        <div class="day-tasks">${dayTasksHtml}</div>
                    </div>
                `;
            });
            
            const weekRange = `${week[0].day}/${week[0].month} - ${week[6].day}/${week[6].month}`;
            
            this.elements.calendarContainer.innerHTML = `
                <div class="weekly-view">
                    <div class="week-navigation">
                        <button class="nav-btn prev-week"><i class="fas fa-chevron-right"></i></button>
                        <span id="week-range">الأسبوع: ${weekRange}</span>
                        <button class="nav-btn next-week"><i class="fas fa-chevron-left"></i></button>
                    </div>
                    <div class="week-calendar">${weekHtml}</div>
                </div>
            `;
        }

        loadMonthlyView() {
            const month = this.taskManager.getCurrentMonth();
            const monthName = new Date().toLocaleDateString('ar-SA', { month: 'long', year: 'numeric' });
            const tasks = this.taskManager.getTasksByTimeRange('monthly');
            
            let monthHtml = '';
            
            // أسماء الأيام
            const daysOfWeek = ['الأحد', 'الإثنين', 'الثلاثاء', 'الأربعاء', 'الخميس', 'الجمعة', 'السبت'];
            daysOfWeek.forEach(day => {
                monthHtml += `<div class="day-header-cell">${day}</div>`;
            });
            
            month.forEach(day => {
                if (day) {
                    const dayTasks = tasks.filter(task => task.date === day.date);
                    const isToday = day.date === new Date().toISOString().split('T')[0];
                    const hasTasks = dayTasks.length > 0;
                    
                    monthHtml += `
                        <div class="day-cell ${isToday ? 'current-day' : ''} ${hasTasks ? 'has-tasks' : ''}">
                            <div class="day-number">${day.day}</div>
                            ${hasTasks ? `<div class="task-indicator" title="${dayTasks.length} مهام"></div>` : ''}
                        </div>
                    `;
                } else {
                    monthHtml += '<div class="day-cell empty"></div>';
                }
            });
            
            this.elements.calendarContainer.innerHTML = `
                <div class="monthly-view">
                    <div class="month-navigation">
                        <button class="nav-btn prev-month"><i class="fas fa-chevron-right"></i></button>
                        <span id="current-month">${monthName}</span>
                        <button class="nav-btn next-month"><i class="fas fa-chevron-left"></i></button>
                    </div>
                    <div class="month-calendar">${monthHtml}</div>
                </div>
            `;
        }

        // ========== عرض الإحصائيات ==========
        loadStatsView() {
            const stats = this.taskManager.getStatistics();
            
            let statsHtml = `
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-tasks" style="color: var(--primary-color)"></i>
                    </div>
                    <div class="stat-value">${stats.totalTasks}</div>
                    <div class="stat-label">إجمالي المهام</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle" style="color: var(--success-color)"></i>
                    </div>
                    <div class="stat-value">${stats.completedTasks}</div>
                    <div class="stat-label">مهام مكتملة</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock" style="color: var(--warning-color)"></i>
                    </div>
                    <div class="stat-value">${stats.pendingTasks}</div>
                    <div class="stat-label">مهام قيد الانتظار</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line" style="color: var(--accent-color)"></i>
                    </div>
                    <div class="stat-value">${stats.completionRate}%</div>
                    <div class="stat-label">نسبة الإنجاز</div>
                </div>
            `;
            
            stats.categoryStats.forEach(category => {
                if (category.total > 0) {
                    statsHtml += `
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="${category.icon}" style="color: ${category.color}"></i>
                            </div>
                            <div class="stat-value">${category.total}</div>
                            <div class="stat-label">${category.name}</div>
                            <div class="stat-sub">مكتملة: ${category.completed}</div>
                        </div>
                    `;
                }
            });
            
            this.elements.statsGrid.innerHTML = statsHtml;
        }

        // ========== عرض الفئات ==========
        loadCategoriesView() {
            const categories = this.taskManager.getCategories();
            
            if (categories.length === 0) {
                this.elements.categoriesList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-tags fa-3x"></i>
                        <h4>لا توجد فئات</h4>
                        <p>اضغط على "إضافة فئة جديدة" لإنشاء فئتك الأولى</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            categories.forEach(category => {
                const taskCount = this.taskManager.getTasksByCategory(category.id).length;
                
                html += `
                    <div class="category-item" data-id="${category.id}">
                        <div class="category-color" style="background: ${category.color}"></div>
                        <i class="${category.icon}"></i>
                        <div class="category-name">
                            <div>${category.name}</div>
                            <small>${taskCount} مهام</small>
                        </div>
                        <div class="category-actions">
                            <button class="btn btn-danger btn-sm delete-category" data-id="${category.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
            
            this.elements.categoriesList.innerHTML = html;
            
            // أحداث حذف الفئات
            document.querySelectorAll('.delete-category').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const categoryId = e.target.closest('button').dataset.id;
                    if (confirm('هل أنت متأكد من حذف هذه الفئة؟ سيتم تعيين مهامها لفئة افتراضية.')) {
                        this.taskManager.deleteCategory(categoryId);
                        this.loadCategoriesView();
                        if (this.currentView === 'tasks') {
                            this.loadTasksView();
                        }
                    }
                });
            });
        }

        // ========== إدارة المهام ==========
        openAddTaskModal() {
            this.loadCategoryOptions();
            this.elements.addTaskModal.classList.add('active');
        }

        loadCategoryOptions() {
            const categories = this.taskManager.getCategories();
            this.elements.taskCategory.innerHTML = '';
            
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = category.name;
                option.style.color = category.color;
                this.elements.taskCategory.appendChild(option);
            });
        }

        saveTask() {
            const title = this.elements.taskTitle.value.trim();
            if (!title) {
                alert('يرجى إدخال عنوان المهمة');
                return;
            }
            
            const task = {
                id: Date.now().toString(),
                title: title,
                description: this.elements.taskDescription.value.trim(),
                categoryId: this.elements.taskCategory.value,
                duration: parseInt(this.elements.taskDuration.value) || 30,
                date: this.elements.taskDate.value,
                time: this.elements.taskTime.value,
                repeat: this.elements.taskRepeat.value,
                completed: false,
                createdAt: new Date().toISOString()
            };
            
            this.taskManager.addTask(task);
            this.closeModal('add-task-modal');
            this.elements.taskForm.reset();
            this.updateDate(); // لتحديث التاريخ في الحقل
            
            if (this.currentView === 'tasks' || this.currentView === 'calendar') {
                this.switchView(this.currentView);
            }
        }

        // ========== إدارة الفئات ==========
        openAddCategoryModal() {
            this.elements.addCategoryModal.classList.add('active');
        }

        saveCategory() {
            const name = this.elements.categoryName.value.trim();
            if (!name) {
                alert('يرجى إدخال اسم الفئة');
                return;
            }
            
            const category = {
                id: Date.now().toString(),
                name: name,
                color: this.elements.categoryColor.value,
                icon: this.elements.categoryIcon.value,
                createdAt: new Date().toISOString()
            };
            
            this.taskManager.addCategory(category);
            this.closeModal('add-category-modal');
            this.elements.categoryForm.reset();
            this.loadCategoriesView();
        }

        // ========== أدوات مساعدة ==========
        closeModal(modalId) {
            document.getElementById(modalId)?.classList.remove('active');
        }

        formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ar-SA');
        }
    }

    // ========== بدء التطبيق ==========
    document.addEventListener('DOMContentLoaded', () => {
        console.log('بدء تحميل تطبيق إدارة المهام...');
        
        try {
            const taskManager = new TaskManager();
            const ui = new UI(taskManager);
            
            console.log('✅ تم تحميل التطبيق بنجاح!');
            console.log(`📊 المهام: ${taskManager.getTasks().length}`);
            console.log(`🏷️ الفئات: ${taskManager.getCategories().length}`);
            
        } catch (error) {
            console.error('❌ خطأ في تحميل التطبيق:', error);
            alert('حدث خطأ في تحميل التطبيق. يرجى تحديث الصفحة.');
        }
    });
    </script>
</body>
</html>
